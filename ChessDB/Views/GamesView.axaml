<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:ChessDB.ViewModels"
             x:conv="clr-namespace:ChessDB.Converters"
             x:DataType="vm:GamesViewModel"
             x:Class="ChessDB.Views.GamesView">

  <StackPanel Margin="12" Spacing="8">
    <TextBlock Text="Encodage des parties" FontSize="16"/>

    <StackPanel Orientation="Horizontal" Spacing="8">
      <StackPanel>
        <TextBlock Text="Compétition"/>
        <ComboBox Width="300"
                  ItemsSource="{Binding DataContext.CompetitionsVM.Competitions, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedValue="{Binding SelectedCompetitionId, Mode=TwoWay}"
                  SelectedValuePath="Id"
                  DisplayMemberPath="Name"/>
      </StackPanel>

      <StackPanel>
        <TextBlock Text="Blanc"/>
        <ComboBox Width="250"
                  ItemsSource="{Binding DataContext.PlayersVM.Players, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedValue="{Binding SelectedWhitePlayer, Mode=TwoWay}"
                  SelectedValuePath="Id"
                  ItemTemplate="{StaticResource PlayerTemplate}"/>
      </StackPanel>

      <StackPanel>
        <TextBlock Text="Noir"/>
        <ComboBox Width="250"
                  ItemsSource="{Binding DataContext.PlayersVM.Players, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedValue="{Binding SelectedBlackPlayer, Mode=TwoWay}"
                  SelectedValuePath="Id"
                  ItemTemplate="{StaticResource PlayerTemplate}"/>
      </StackPanel>
    </StackPanel>

    <StackPanel Orientation="Horizontal" Spacing="8">
      <TextBlock Text="Résultat" VerticalAlignment="Center"/>
      <ComboBox Width="120" SelectedItem="{Binding Result}">
        <ComboBoxItem Content="1-0"/>
        <ComboBoxItem Content="0-1"/>
        <ComboBoxItem Content="1/2-1/2"/>
      </ComboBox>

      <TextBox Width="400" Watermark="Moves (ex: e4 e5 Nf3 ...)" Text="{Binding MovesInput}"/>
      <Button Content="Ajouter partie" Command="{Binding AddGameCommand}"/>
    </StackPanel>

    <TextBlock Text="Historique des parties" Margin="0,8,0,0"/>
    <ListBox ItemsSource="{Binding Games}" Height="250">
      <ListBox.ItemTemplate>
        <DataTemplate>
          <StackPanel Orientation="Horizontal" Spacing="12">
            <TextBlock Text="{Binding PlayedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}"/>
            <TextBlock Text="{Binding WhitePlayer}" />
            <TextBlock Text=" vs " />
            <TextBlock Text="{Binding BlackPlayer}" />
            <TextBlock Text="{Binding Moves}" />
            <TextBlock Text="{Binding WinnerId, Converter={x:NullToStringConverter}, StringFormat='Winner: {0}'}"/>
          </StackPanel>
        </DataTemplate>
      </ListBox.ItemTemplate>
    </ListBox>

  </StackPanel>
</UserControl>
